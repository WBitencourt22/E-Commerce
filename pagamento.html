<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagamento - Finalizar Compra</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>

<body class="checkout-page-body">
    <header class="header">
        <div class="header-logo">
            <a href="index.html" class="home-link">
                <span class="logo-text">MINHA LOJA</span>
            </a>
        </div>
        <form class="search-bar" onsubmit="event.preventDefault();">
            <input type="text" placeholder="Pesquisar no site...">
            <button type="submit">üîç</button>
        </form>
        <div class="header-icons">
            <span class="material-symbols-outlined icon" onclick="window.location.href='index.html'">home</span>
            <div class="cart-icon-container" onclick="openCart()">
                <span class="material-symbols-outlined icon">shopping_cart_checkout</span>
                <span id="cart-badge" class="cart-badge" style="display: none;">0</span>
            </div>
        </div>
    </header>

    <main class="container main-content">

        <div class="checkout-grid">

            <section class="order-summary">
                <h2>Resumo do Pedido</h2>
                <div id="cart-summary-items" class="cart-summary-items">
                    <p id="loading-message">Carregando carrinho...</p>
                </div>

                <div class="order-total-area">
                    <div class="order-subtotal">
                        <span>Subtotal:</span>
                        <span id="subtotal-value">R$ 0.00</span>
                    </div>
                    <div class="order-shipping">
                        <span>Frete:</span>
                        <span id="shipping-value">R$ 15.00</span>
                    </div>
                    <div class="order-total">
                        <strong>Total Geral:</strong>
                        <strong id="total-value">R$ 0.00</strong>
                    </div>
                </div>
            </section>

            <section class="payment-method">
                <h2>Forma de Pagamento</h2>
                <form id="payment-form" onsubmit="event.preventDefault(); processPayment();">

                    <div class="payment-options">
                        <label class="payment-option">
                            <input type="radio" name="payment" value="pix" required>
                            <span>PIX - Pagamento Imediato (Ganhe 5% OFF)</span>
                        </label>
                        <label class="payment-option">
                            <input type="radio" name="payment" value="credit_card">
                            <span>Cart√£o de Cr√©dito - <strong id="installments-summary">At√© 12x</strong></span>
                        </label>
                        <label class="payment-option">
                            <input type="radio" name="payment" value="bank_slip">
                            <span>Boleto Banc√°rio</span>
                        </label>
                    </div>

                    <div id="payment-details" style="margin-top: 20px;">
                    </div>

                    <div class="location-panel" style="margin-top:20px;">
                        <h3>Local de Entrega</h3>
                        <p>Coordenadas selecionadas: <span id="selected-coords">Nenhuma</span></p>
                        <p>Dist√¢ncia at√© a loja: <span id="distance-value">-- km</span></p>
                        <p>CEP: <input type="text" id="cep-input" class="cep-input" placeholder="Digite o CEP (somente n√∫meros)"> <button type="button" id="cep-search-btn" class="cep-btn">Buscar CEP</button></p>
                        <p>Endere√ßo encontrado: <span id="cep-address">--</span></p>
                        <div id="map" style="height: 300px; margin-top:10px;"></div>
                    </div>

                    <button type="submit" class="btn-checkout">Finalizar Pedido</button>
                    <button type="button" class="btn-back" onclick="window.location.href='index.html'">Continuar
                        Comprando</button>
                </form>
            </section>
        </div>
    </main>
    <div id="pix-modal" class="modal-pix">
        <div class="modal-pix-content">
            <div class="modal-header">
                <h2>PIX - Confirma√ß√£o de Pagamento</h2>
                <span class="close-pix-modal" onclick="closePixModal()">&times;</span>
            </div>
            <div id="pix-modal-body">
            </div>
            <div class="modal-footer">
                <p>O pedido ser√° enviado ap√≥s a confirma√ß√£o do pagamento.</p>
                <button class="btn-back" onclick="closePixModal()">Entendi, Voltar √† Loja</button>
            </div>
        </div>
    </div>
    <!-- mapa foi movido para dentro do card de pagamento -->

    <div id="cart-modal" class="cart-modal">
        <div class="cart-modal-content">
            <div class="cart-header">
                <h2>Meu Carrinho</h2>
                <button class="close-cart" onclick="closeCart()">&times;</button>
            </div>
            <div class="cart-items" id="cart-items"></div>
            <div class="cart-footer" id="cart-footer" style="display: none;">
                <div class="cart-total">
                    <span class="cart-total-label">Total:</span>
                    <span class="cart-total-value" id="cart-total">R$ 0.00</span>
                </div>
                <button class="checkout-btn" onclick="checkout()">Finalizar Compra</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="pagamento.js"></script>
    <footer class="footer">Todos direitos reservados</footer>
</body>

</html>